<!doctype html>
<head>
	<meta charset="utf-8">
	<link href="css/normalize.css" rel="stylesheet">
	<link href="//code.jquery.com/ui/1.10.3/themes/cupertino/jquery-ui.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">

	<script src="js/jquery-1.9.1.js"></script>
	<script src="js/uri.js"></script>
	<script src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script src="js/handlebars-1.0.0.js"></script>
	<script src="js/ember_debug.js"></script>
	<script src="js/ember-data.js"></script>
	<script src="js/jqplugins.js"></script>
	<script src="js/app.js"></script>
	<script src="js/api.js"></script>
	<script src="js/selector.js"></script>
	<script src="js/canvas.js"></script>
	<script src="js/models.js"></script>
	<script src="js/routes.js"></script>
	<script src="js/emberui.js"></script>
	<script src="js/views.js"></script>
	<script src="js/controllers.js"></script>
	
</head>
<body>	

<!-- Main template -->
<script type="text/x-handlebars">
	<div id="toolbar">
		<div style='margin-top:10px; margin-bottom:10px'>
			{{view JQ.TabNavigator templateName="navigation-template"}}
		</div>
		<div id="toolbar-container" class="ui-corner-all">
			{{outlet}}
		</div>
	</div>
	{{view ASTool.AnnotatedDocumentView}}
</script>

<!-- Navigation template -->
<script type="text/x-handlebars" id="navigation-template">
	<div id="navigationbar" class="ui-corner-all">
		{{#each routeStack}}
			<span {{action "gotoRoute" this.route}} class="navRoute">{{this.label}}</span> >
		{{/each}}
	</div>
</script>

<!-- Annotated document view -->
<script type="text/x-handlebars" id="annotated-document-view">
	<div id="scraped-doc">
		<iframe id="scraped-doc-iframe" src="start.html"> </iframe>
		<canvas id="infocanvas"></canvas>
		<div id="hoveredInfo"></div>
	</div>
</script>

<!-- Project template -->
<script type="text/x-handlebars" id="project">
	<div style='width: 100%; text-align:center'>
		<h3>Project test</h3>
		<hr/>
		<h3>Spiders for this project:</h3>
		<div class="scrolling-container ui-corner-all">
			{{#each}}
				<div style="margin: 4px 0px 4px 0px">
					{{view JQ.ButtonView action="editSpider" argument=this label=this minWidth='300px'}}
				</div>
			{{else}}
				<h3>No spiders for this project.</h3>.
			{{/each}}
		</div>
		<div style="margin-top:10px">
			{{view JQ.ButtonView action="addSpider" icon="ui-icon-circle-plus" label="New spider"}}
		</div>
		<hr/>
		{{view JQ.ButtonView action="gotoItems" argument=this icon="ui-icon-circle-triangle-e" label='Items'}}

	</div>
</script>

<!-- Spider template -->
<script type="text/x-handlebars" id="spider">
	<div style='width: 100%; text-align:center'>
		<h3>Spider {{name}}</h3>
		<hr/>
		<h3>Start URLs</h3>
		<div class="scrolling-container ui-corner-all" style="max-height: 150px;">
			{{#each start_urls}}
				<div style="margin: 4px 0px 4px 0px">
					{{view JQ.ButtonView action="loadPage" argument=this label=this minWidth='300px'}}
					{{view JQ.ButtonView action="deleteStartUrl" argument=this icon="ui-icon-trash" label="x" text=false}}
				</div>
			{{else}}
				<h3>No start urls for this spider.</h3>
			{{/each}}
		</div>
		<div style="margin-top:5px">
			<h4>New start URL</h4>
			{{view JQ.TextField value=newStartUrl class="mediumtextarea" width='240px'}}
			{{view JQ.ButtonView action="addStartUrl" icon="ui-icon-circle-plus" label="Add url"}}
		</div>
		<hr/>
		<h3>Templates</h3>
		<div class="scrolling-container ui-corner-all" style="max-height: 150px;">
			{{#each templates}}
				<div style="margin: 4px 0px 4px 0px">
					{{view JQ.ButtonView action="editTemplate" argument=this label=name minWidth='300px'}}
					{{view JQ.ButtonView action="deleteTemplate" argument=this icon="ui-icon-trash" label="x" text=false}}
				</div>
			{{else}}
				<h3>No templates for this spider.</h3>
			{{/each}}
		</div>
		{{#if loadedUrl}}
			<div style="margin-top: 10px">
				{{view JQ.ButtonView action="addTemplate" icon="ui-icon-circle-plus" label="Add a template for this page"}}
			<div/>
		{{else}}
			<h4>Browse from one of the start URLs to add a template.</h4>
		{{/if}}
		<hr/>
		{{view JQ.ButtonView action="saveSpider" icon="ui-icon-disk" label="Save spider"}}
		{{view JQ.ButtonView action="back" icon=" ui-icon-circle-triangle-w" label="Back to project"}}
	</div>
	</div>
</script>


<!-- Annotations list -->
<script type="text/x-handlebars" id="annotations">
	<div style='text-align: center; width:100%;'>
		<h3>Template {{template.name}}</h3>
		<hr/>
		<h3>Annotations</h3>
		<div class="scrolling-container ui-corner-all">
			{{#each}}
				<div style="margin: 4px 0px 4px 0px">
					{{view JQ.AnnotationWidget action="editAnnotation" argument=this label=name  minWidth='300px'}}
					{{view JQ.ButtonView action="deleteAnnotation" argument=this icon="ui-icon-trash" label="x" text=false}}
				</div>
				{{else}}
					<h4>No annotations have been defined yet.</h4>
			{{/each}}
		</div>
		<div style="margin-top:10px">
				{{view JQ.ButtonView action="addAnnotation" icon="ui-icon-circle-plus" label="New annotation"}}
		</div>
		<hr/>
		{{view JQ.ButtonView action="back" icon=" ui-icon-circle-triangle-w" label="Back to spider"}}
	</div>
</script>


<!-- Edit annotation template -->
<script type="text/x-handlebars" id="annotation">
	<div style="text-align: center">
		<label class="bigLabel">Annotation </label>{{view JQ.TextField value=name class="mediumtextarea"}}
		<div style="margin-top:10px"/>
		{{#if path}}
			<hr/>
			<h3>Path</h3>
				<div class="scrolling-container ui-corner-all">
					<h3>{{path}}</h3>
				</div>
			<hr/>
			<h3>Attributes</h3>
			<div class="scrolling-container ui-corner-all">
				{{#if mappedAttributes}}
					<h4 style="margin-bottom: 5px">Mapped</h4>
					{{#each mappedAttributes}}
						<div style="margin: 4px 0px 4px 0px">
							{{view ASTool.ElemAttributeView mapped=true icon="ui-icon-circle-close" attribute=this minWidth='336px'
							  maxWidth='336px' action="unmapAttribute" argument=this}}
						</div>
					{{/each}}
				{{/if}}

				{{#if unmappedAttributes}}
					<h4 style="margin-bottom: 5px">Not mapped</h4>
					{{#each unmappedAttributes}}
						<div style="margin: 4px 0px 4px 0px">
							{{view ASTool.ElemAttributeView icon="ui-icon-transferthick-e-w" attribute=this minWidth='336px'
						      maxWidth='336px' action="mapAttribute" argument=this}}
						</div>
					{{/each}}
				{{/if}}
			</div>
			<hr/>
			<h3>Ignored regions</h3>
			<div class="scrolling-container ui-corner-all">
				{{#each model.ignores}}
					<div style="margin: 4px 0px 4px 0px">
						{{view JQ.IgnoreWidget ignore=this class="mediumtextarea" width='300px'}}
						{{view JQ.ButtonView action="deleteIgnore" argument=this icon="ui-icon-trash" label="x" text=false}}
					</div>
				{{else}}
					<h4>No ignored regions defined.</h4>
				{{/each}}
			</div>
			<div style="margin-top:10px">
				{{view JQ.ButtonView action="addIgnore" label="Ignore region" icon="ui-icon-cancel" id="addIgnore"}}
			</div>
		{{else}}
			<h4>Please select an element or region from the document.</h4>
		{{/if}}
		<hr/>
		{{#if element}}
			{{view JQ.ButtonView action="doneEditing" argument=model icon="ui-icon-circle-check" label="Ok"}}
		{{/if}}
		{{view JQ.ButtonView action="cancelEdit" argument=model icon="ui-icon-circle-close" label="Cancel"}}
	</div>
	
</script>

<!-- Items list -->
<script type="text/x-handlebars" id="items">
	<div style="text-align: center">
		{{#if mappingAttribute}}
			<h3>Choose an item field to map "{{mappingAttribute.name}}"</h3>
		{{else}}
			<h3>Items</h3>
		{{/if}}
		<hr/>
		{{#each model}}
			{{view ASTool.ItemView item=this mappingAttribute=controller.mappingAttribute}}
			<hr/>
	 	{{else}}
	 		<h4>No items have been defined yet.</h4>
			<hr/>
	 	{{/each}}
		{{view JQ.ButtonView action="addItem" icon="ui-icon-circle-plus" label="New item"}}
		{{view JQ.ButtonView action="back" icon="ui-icon-circle-triangle-w" label="Back"}}
	</div>
</script>


<!-- Item View -->
<script type="text/x-handlebars" id="item">
	<span class="mediumLabel">Name </span>
	{{view JQ.EditField owner=view.item value=view.item.name class="mediumtextarea"}}
	{{view JQ.ButtonView action="addField" argument=this icon="ui-icon-circle-plus" label="New field"}}
	<div style="text-align: center; margin-top:10px">
		{{#if view.item.fields}}
			<table style="margin: 0 auto;">
				<tr class="smallLabel"> <td>Field name</td> <td>Type</td> <td>Required</td> <td>Vary</td> </tr>
				{{#each view.item.fields}}
					<tr>
						<td>{{view JQ.TextField owner=this value=name class="mediumtextarea"}}</td>
						<td>{{view ASTool.TypeSelect owner=this selection=type}}</td>
						<td>{{view ASTool.EditBox owner=this checked=required}}</td>
						<td>{{view ASTool.EditBox owner=this checked=vary}}</td>
						{{#if view.mappingAttribute}}
							<td>{{view JQ.ButtonView action="chooseField" argument=this icon="ui-icon-circle-triangle-e" label="Choose"}}</td>
						{{/if}}
					</tr>
				{{/each}}
			</table>
		{{else}}
			<h4>No fields defined yet.</h4>
		{{/if}}
	</div>
</script>

</body>